# LensClip

**æ•£æ­©ãŒã€å†’é™ºã«ãªã‚‹ã€‚**

ã€Œã“ã‚Œãªãã«ï¼Ÿã€
ãã®ä¸€è¨€ã‹ã‚‰ã€ä¼šè©±ãŒå§‹ã¾ã‚‹ã€‚

å†™çœŸã‚’1æšæ’®ã‚‹ã ã‘ã§ã€å­ã©ã‚‚ã«ã‚ã‹ã‚‹è¨€è‘‰ã§æ•™ãˆã¦ãã‚Œã‚‹ã€‚
è¦ªå­ã§ä½¿ã†ã€ãƒ‡ã‚¸ã‚¿ãƒ«å›³é‘‘ã‚¢ãƒ—ãƒªã€‚

**ãƒ‡ãƒ¢**: https://lensclip.up.railway.app/

---

## ã“ã‚“ãªç¬é–“ã®ãŸã‚ã«

å…¬åœ’ã§è¦‹ã¤ã‘ãŸè™«ã€æ•£æ­©ä¸­ã«æ°—ã«ãªã£ãŸè‰èŠ±ã€ç©ºã‚’é£›ã¶é³¥ã®åå‰â€”â€”

ã€Œãªã‚“ã§ï¼Ÿã€ã€Œã“ã‚Œãªã«ï¼Ÿã€ã¨èã‹ã‚ŒãŸã¨ãã€
ã¡ã‚ƒã‚“ã¨ç­”ãˆã¦ã‚ã’ã‚‰ã‚Œã‚‹ã€‚ãã®ç¬é–“ã‚’ã€ã‚¢ãƒ—ãƒªãŒä¸€ç·’ã«ä½œã‚Šã¾ã™ã€‚

ä½•æ°—ãªã„æ•£æ­©ãŒã€å¿˜ã‚Œã‚‰ã‚Œãªã„æ€ã„å‡ºã«å¤‰ã‚ã‚‹ã€‚

---

## å­ã©ã‚‚ã«ã¯ã€è‡ªåˆ†ã ã‘ã®å›³é‘‘ãŒã§ãã‚‹

æ’®ã£ãŸç™ºè¦‹ã¯ã€ã™ã¹ã¦ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«æ®‹ã‚Šã¾ã™ã€‚
æ—¥ä»˜ãƒ»ã‚«ãƒ†ã‚´ãƒªãƒ»ã‚¿ã‚°ã§æ•´ç†ã•ã‚Œã¦ã„ãã‹ã‚‰ã€
ä½¿ã†ãŸã³ã«**ä¸–ç•Œã«ã²ã¨ã¤ã ã‘ã®å›³é‘‘**ãŒè‚²ã£ã¦ã„ãã€‚

---

## ä½¿ã„æ–¹ã¯ã€å†™çœŸã‚’æ’®ã‚‹ã ã‘

```
ğŸ“· æ°—ã«ãªã‚‹ã‚‚ã®ã‚’æ’®ã‚‹
        â†“
ğŸ“– å­ã©ã‚‚ã«ã‚ã‹ã‚‹è¨€è‘‰ã§èª¬æ˜ãŒå±Šã
        â†“
ğŸ“š ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«ä¿å­˜ã•ã‚Œã¦ã€å›³é‘‘ãŒè‚²ã¤
```

èª¬æ˜ã¯å­ã©ã‚‚ã«ã‚ã‹ã‚‹è¨€è‘‰ã§å±Šãã¾ã™ã€‚
ç”»é¢ã‚’ä¸€ç·’ã«è¦‹ãªãŒã‚‰ã€ä¼šè©±ã®ãã£ã‹ã‘ã«ã—ã¦ãã ã•ã„ã€‚

---

## ã§ãã‚‹ã“ã¨

- **ãã®å ´ã§èª¿ã¹ã‚‹** â”€â”€ ã‚«ãƒ¡ãƒ©ã§ãƒ‘ã‚·ãƒ£ã£ã¨æ’®ã‚‹ã ã‘
- **è¤‡æ•°ã®å€™è£œãŒå‡ºã‚‹** â”€â”€ ã€Œã“ã‚Œã‹ã‚‚ã€ã‚’å­ã©ã‚‚ã¨ä¸€ç·’ã«é¸ã¹ã‚‹
- **å›³é‘‘ã¨ã—ã¦æ®‹ã‚‹** â”€â”€ æ—¥ä»˜ãƒ»ã‚«ãƒ†ã‚´ãƒªãƒ»åœ°å›³ã§æŒ¯ã‚Šè¿”ã‚Œã‚‹
- **ã‚¿ã‚°ã‚’ã¤ã‘ã‚‰ã‚Œã‚‹** â”€â”€ ã€Œã“ã†ãˆã‚“ã€ã€ŒãŠãã«ã„ã‚Šã€ãªã©è‡ªç”±ã«æ•´ç†
- **èª¿ã¹ãªãŠã›ã‚‹** â”€â”€ ã‚‚ã†ä¸€å›ç¢ºèªã—ãŸã„ã¨ãã¯ãƒ¯ãƒ³ã‚¿ãƒƒãƒ—

---

## AI ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³

Gemini ã«ç”»åƒã‚’ãã®ã¾ã¾æ¸¡ã™ã®ã§ã¯ãªãã€ã¾ãš Vision API ã§ä¸»å¯¾è±¡ã‚’ bbox ã§åˆ‡ã‚Šå‡ºã—ã¦ã‹ã‚‰æ¸¡ã™2æ®µæ§‹ãˆã®è¨­è¨ˆã«ã—ã¦ã„ã¾ã™ã€‚èƒŒæ™¯ãƒã‚¤ã‚ºã‚’æ’é™¤ã™ã‚‹ã“ã¨ã§åŒå®šç²¾åº¦ãŒä¸ŠãŒã‚Šã€bbox ãŒå–ã‚Œãªã„å ´åˆã¯å…ƒç”»åƒã«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã™ã‚‹ãŸã‚ã€ã©ã¡ã‚‰ã«è»¢ã‚“ã§ã‚‚æ­¢ã¾ã‚‰ãªã„æ§‹é€ ã§ã™ã€‚

```mermaid
sequenceDiagram
    participant User as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant App as Web Server
    participant Q as Queue Worker
    participant Vision as Cloud Vision API
    participant Gemini as Gemini API
    participant GCS as Cloud Storage

    User->>App: ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
    App->>GCS: original + thumb ä¿å­˜
    App->>Q: Job ã‚’ã‚­ãƒ¥ãƒ¼æŠ•å…¥
    App-->>User: { status: processing }

    Q->>Vision: Object Localization
    Vision-->>Q: bbox åº§æ¨™ï¼ˆä¸»å¯¾è±¡ã®ä½ç½®ï¼‰
    Q->>GCS: crop ç”»åƒã‚’ä¿å­˜
    Q->>Gemini: crop ç”»åƒ + ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
    Gemini-->>Q: JSONï¼ˆtitle / summary / kid_friendly ...ï¼‰
    Q-->>Q: status = ready

    User->>App: ãƒãƒ¼ãƒªãƒ³ã‚°ï¼ˆ1 ç§’é–“éš”ï¼‰
    App-->>User: { status: ready, title: "ãƒ†ãƒ³ãƒˆã‚¦ãƒ ã‚·", ... }
```

---

## è¨­è¨ˆã®åˆ¤æ–­

**å†ªç­‰ Job ã§å®‰å…¨ãªãƒªãƒˆãƒ©ã‚¤**
`AnalyzeObservationJob` ã¯ status ãŒ `processing` ä»¥å¤–ãªã‚‰å³ãƒªã‚¿ãƒ¼ãƒ³ã€‚åˆ†æ•£ã‚­ãƒ¥ãƒ¼ã§ã¯é‡è¤‡å®Ÿè¡ŒãŒèµ·ãã†ã‚‹ãŸã‚ã€å†ªç­‰æ€§ã‚’æœ€åˆã‹ã‚‰è¨­è¨ˆã«çµ„ã¿è¾¼ã‚“ã ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒªãƒˆãƒ©ã‚¤ã‚‚ status ã‚’ `processing` ã«æˆ»ã—ã¦ã‹ã‚‰å†æŠ•å…¥ã™ã‚‹ä¸€æ–¹å‘è¨­è¨ˆã«ã—ã¦ã„ã‚‹ã€‚

**ç’°å¢ƒä¾å­˜ã‚’ã‚¼ãƒ­ã«ã™ã‚‹æŠ½è±¡åŒ–**
ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¯ `Storage` ãƒ•ã‚¡ã‚µãƒ¼ãƒ‰ã§å®Ÿè£…ã— `FILESYSTEM_DISK` ä¸€æœ¬ã§ GCSï¼ãƒ­ãƒ¼ã‚«ãƒ«ã‚’åˆ‡ã‚Šæ›¿ãˆã€‚Google Cloud èªè¨¼ã¯ Application Default Credentials ã§ Vision / Gemini / GCS ã‚’çµ±ä¸€ã€‚ã‚³ãƒ¼ãƒ‰ã‚’å¤‰ãˆãšã«ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã‹ã‚‰æœ¬ç•ªã¾ã§å‹•ãã€‚

**æ“ä½œè€…ã¨ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åˆ†é›¢**
ã‚¢ãƒ—ãƒªã‚’æ“ä½œã™ã‚‹ã®ã¯è¦ªã€ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’å—ã‘å–ã‚‹ã®ã¯å­ã©ã‚‚ã¨ã„ã†äºŒå±¤è¨­è¨ˆã€‚ã“ã®å‰æãŒ UIï¼ˆã‚·ãƒ³ãƒ—ãƒ«ãªå°ç·šãƒ»å¤§ããªã‚¿ãƒƒãƒã‚¿ãƒ¼ã‚²ãƒƒãƒˆï¼‰ã¨ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆ`kid_friendly` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ï¼‰ã®ä¸¡æ–¹ã«ä¸€è²«ã—ã¦å½±éŸ¿ã—ã¦ã„ã‚‹ã€‚

---

## ã‚¹ã‚¿ãƒƒã‚¯

![Laravel](https://img.shields.io/badge/Laravel-12-FF2D20?style=flat&logo=laravel&logoColor=white)
![React](https://img.shields.io/badge/React-18-61DAFB?style=flat&logo=react&logoColor=black)
![TypeScript](https://img.shields.io/badge/TypeScript-5-3178C6?style=flat&logo=typescript&logoColor=white)
![Google Cloud](https://img.shields.io/badge/Google_Cloud-4285F4?style=flat&logo=googlecloud&logoColor=white)
![Railway](https://img.shields.io/badge/Railway-0B0D0E?style=flat&logo=railway&logoColor=white)

| ã‚«ãƒ†ã‚´ãƒª | æŠ€è¡“ | é¸å®šç†ç”± |
|---------|------|---------|
| Backend | Laravel 12 + Inertia.js | å …ç‰¢ãª MVC + SPA çš„ UX ã‚’æœ€å°æ§‹æˆã§å®Ÿç¾ |
| Frontend | React + TypeScript | å‹å®‰å…¨ãª UI é–‹ç™ºã€Inertia ã«ã‚ˆã‚‹ SSR å¯¾å¿œ |
| ç”»åƒèªè­˜ | Cloud Vision API | Object Localization ã§ä¸»å¯¾è±¡ã‚’ bbox å–å¾— |
| èª¬æ˜ç”Ÿæˆ | Gemini API | ãƒãƒ«ãƒãƒ¢ãƒ¼ãƒ€ãƒ« + JSON mode ã§æ§‹é€ åŒ–å‡ºåŠ› |
| ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ | Google Cloud Storage / ãƒ­ãƒ¼ã‚«ãƒ« | `FILESYSTEM_DISK` ã§åˆ‡ã‚Šæ›¿ãˆå¯èƒ½ã€‚GCS ä½¿ç”¨æ™‚ã¯ã‚µãƒ¼ãƒ“ã‚¹ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ 1 æœ¬ã§ Vision / Gemini / GCS ã‚’çµ±åˆ |
| Queue | Redis + Laravel Jobs | éåŒæœŸå‡¦ç†ãƒ»å†ªç­‰ãƒªãƒˆãƒ©ã‚¤è¨­è¨ˆ |
| Auth | Laravel Breeze + Socialite | ãƒ¡ãƒ¼ãƒ«èªè¨¼ + Google OAuth ã‚’æœ€å°ã‚³ã‚¹ãƒˆã§å®Ÿè£… |
| Deploy | Railway | Docker ãƒ™ãƒ¼ã‚¹ã®å³æ™‚ãƒ‡ãƒ—ãƒ­ã‚¤ã€MySQL + Redis + Volume ã‚’ä¸€å…ƒç®¡ç† |

---

## Quick Start

```bash
cp .env.example .env           # API ã‚­ãƒ¼ã‚’è¨­å®š
./vendor/bin/sail up -d
./vendor/bin/sail artisan migrate && ./vendor/bin/sail artisan storage:link
./vendor/bin/sail npm run dev
```

è©³ç´°ã¯ [Setup Guide](docs/setup.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

---

## License

MIT
